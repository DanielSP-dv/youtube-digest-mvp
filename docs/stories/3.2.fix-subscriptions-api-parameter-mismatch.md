# Story 3.2: Fix Subscriptions API Parameter Mismatch

## Problem
The `/api/subscriptions` endpoint was returning a 500 error with "Not authenticated" even though users were successfully logged in and the dashboard was working fine.

## Root Cause Analysis
**Parameter Mismatch Bug**: The `server.js` file was calling `getSubscriptions()` with only one parameter, but the function in `youtube.js` expected two parameters (accessToken AND refreshToken).

```javascript
// BROKEN (server.js line 145):
const subscriptions = await youtubeService.getSubscriptions(req.user.access_token);

// EXPECTED BY youtube.js:
async function getSubscriptions(accessToken, refreshToken) { ... }
```

This mismatch caused the YouTube API authentication to fail, even though the user session was valid.

## Solution
Updated the `/api/subscriptions` endpoint in `server.js` to pass both required parameters:

```javascript
// FIXED (server.js line 145):
const subscriptions = await youtubeService.getSubscriptions(
  req.user.access_token,
  req.user.refresh_token
);
```

## QA Results

### Review Date: 2025-09-09

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment
The bug fix is correct. The call to `youtubeService.getSubscriptions` in `server.js` now correctly passes both the `access_token` and `refresh_token`, matching the function signature in `services/youtube.js`. This resolves the parameter mismatch that was causing the authentication issue with the YouTube API.

### Refactoring Performed
None required.

### Compliance Check
- Coding Standards: ✓
- Project Structure: ✓
- Testing Strategy: ✓ (Manual verification is appropriate for this story)
- All ACs Met: ✓

### Improvements Checklist
- [x] All items addressed.

### Gate Status
Gate: PASS → docs/qa/gates/3.2.fix-subscriptions-api-parameter-mismatch.yml

### Recommended Status
✓ Ready for Done
