# Story 9.1: Implement Production Auth and Asset Serving Fixes

## Status: In Progress

## Story
**As a** developer,
**I want** to correctly configure the Express server for production proxies and simplify asset serving,
**so that** the user authentication session persists correctly after redirects and the application is stable on Railway.

## Problem
The root cause of the login redirect loop is the server not trusting the production proxy, which prevents secure session cookies from being set. Additionally, the server logic for handling frontend assets is overly complex and can be simplified.

## Acceptance Criteria:
1. `server.js` must be configured with `app.set('trust proxy', 1)`.
2. The Google OAuth callback in `server.js` must redirect to the client's root (`/`).
3. `App.jsx` must contain a `useEffect` hook to programmatically navigate to `/dashboard` after a successful login.
4. The complex manifest-rewriting logic in `server.js` must be removed and replaced with a simple `res.sendFile` for `index.html`.
5. The application's login flow must work correctly on the live Railway deployment.

## Tasks / Subtasks

- [ ] **Task 1: Revert Previous Client-Side Redirect Logic**
    - [ ] Revert the changes made to `App.jsx` in the previous session to ensure a clean slate for the new logic.

- [ ] **Task 2: Patch `server.js`** (AC: 1, 2, 4)
    - [ ] Add `app.set('trust proxy', 1)`.
    - [ ] Change the OAuth callback to redirect to the root URL.
    - [ ] Remove the `renderIndexWithFreshAssets` function and replace the catch-all route with a simple `res.sendFile`.

- [ ] **Task 3: Patch `App.jsx`** (AC: 3)
    - [ ] Add the `useEffect` hook that uses `useNavigate` to redirect to `/dashboard` after the user state is confirmed.

## Dev Notes
*   This story implements the definitive fixes provided by the audit team.
*   The `trust proxy` setting is the critical fix for the session cookie issue.
*   Simplifying the asset serving logic makes the server more robust and less dependent on specific build manifest formats.
