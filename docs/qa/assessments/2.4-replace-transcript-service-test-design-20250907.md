# Test Design: Story 2.4

Date: 2025-09-07
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 5
- Unit tests: 0
- Integration tests: 4
- E2E tests: 1
- Priority distribution: P0: 4, P1: 1

## Test Scenarios by Acceptance Criteria

### AC1: The `getVideoTranscript` function in `services/transcript.js` is updated to use the Supadata API.

#### Scenarios

| ID | Level | Priority | Test | Justification |
|---|---|---|---|---|
| 2.4-INT-001 | Integration | P0 | Verify `getVideoTranscript` makes a POST request to Supadata API with correct endpoint and `videoId` in body. | Verifies the core change in API integration. |

### AC2: The updated `getVideoTranscript` function successfully fetches transcripts for YouTube videos.

#### Scenarios

| ID | Level | Priority | Test | Justification |
|---|---|---|---|---|
| 2.4-INT-002 | Integration | P0 | Verify `getVideoTranscript` returns a valid transcript for a known YouTube video ID. | Validates successful data retrieval from Supadata. |
| 2.4-INT-003 | Integration | P1 | Verify `getVideoTranscript` handles cases where Supadata API returns an error or no transcript. | Tests error handling and robustness. |

### AC3: The `SUPADATA_API_KEY` is securely loaded from environment variables and used for Supadata API authentication.

#### Scenarios

| ID | Level | Priority | Test | Justification |
|---|---|---|---|---|
| 2.4-INT-004 | Integration | P0 | Verify `getVideoTranscript` fails gracefully when `SUPADATA_API_KEY` is missing or invalid. | Critical for security and proper configuration. |

### AC4: The application continues to successfully generate video summaries using transcripts fetched via Supadata.

#### Scenarios

| ID | Level | Priority | Test | Justification |
|---|---|---|---|---|
| 2.4-E2E-001 | End-to-End | P0 | Trigger `/api/refresh-videos` and verify that new video summaries are generated and saved to the database. | Validates the entire flow from video fetching to summarization. |

## Risk Coverage

(No specific risks identified in risk profile for this story)

## Recommended Execution Order

1. P0 Integration tests (2.4-INT-001, 2.4-INT-002, 2.4-INT-004)
2. P0 End-to-End test (2.4-E2E-001)
3. P1 Integration test (2.4-INT-003)
